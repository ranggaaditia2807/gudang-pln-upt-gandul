<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Laporan Transaksi - Gudang UPT Gandul</title>
  <link rel="stylesheet" href="styles.css">
  <script src="app-config.js"></script>
  <script src="data-config.js"></script>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-brand">Gudang UPT Gandul</div>
    <div class="nav-links">
      <a href="home.html" class="nav-link">Home</a>
      <a href="dashboard.html" class="nav-link">Dashboard</a>
      <a href="transaksi.html" class="nav-link">Transaksi</a>
      <a href="manajemen-gudang.html" class="nav-link">Manajemen Gudang</a>
      <a href="laporan.html" class="nav-link active">Laporan</a>
    </div>
  </nav>

  <!-- Container Laporan -->
  <section class="container">
    <h1>Laporan Transaksi</h1>
    <div class="table-container">
      <table class="laporan-table">
        <thead>
          <tr>
            <th>Tanggal</th>
            <th>Kode Barang</th>
            <th>Nama Barang</th>
            <th>Jumlah</th>
            <th>Satuan</th>
            <th>Lokasi</th>
            <th>Jenis</th>
          </tr>
        </thead>
        <tbody id="laporanBody"></tbody>
      </table>
    </div>
  </section>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Inisialisasi data barang
      DATA_CONFIG.initData();
      const barangList = DATA_CONFIG.getDataBarang();

      // Ambil transaksi dari localStorage
      const pemasukan = JSON.parse(localStorage.getItem(DATA_CONFIG.STORAGE_KEYS.TRANSAKSI_PEMASUKAN)) || [];
      const pengeluaran = JSON.parse(localStorage.getItem(DATA_CONFIG.STORAGE_KEYS.TRANSAKSI_PENGELUARAN)) || [];

      const laporanBody = document.getElementById('laporanBody');
      laporanBody.innerHTML = '';

      // Render fungsi transaksi
      function renderTransaksi(list, jenis) {
        list.forEach(transaksi => {
          transaksi.barang.forEach(item => {
            const barang = barangList.find(b => b.kode === item.kodeBarang) || {};
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${transaksi.tanggal || '-'}</td>
              <td>${item.kodeBarang}</td>
              <td>${barang.nama || '-'}</td>
              <td>${item.jumlahMasuk || item.jumlahKeluar || 0}</td>
              <td>${barang.satuan || '-'}</td>
              <td>${barang.lokasi || '-'}</td>
              <td>${jenis}</td>
            `;
            laporanBody.appendChild(row);
          });
        });
      }

      renderTransaksi(pemasukan, 'Pemasukan');
      renderTransaksi(pengeluaran, 'Pengeluaran');
    });
  </script>
</body>
</html>
